# Telegram OpenWebUI Bot

This project integrates a Telegram bot with [OpenWebUI](https://github.com/OpenWebUI/open-webui), enabling interaction with an AI model directly through Telegram. It supports conversational commands, chat summaries, and context-aware interactions.

## Features

- **`/chat <message>`**: Engage with the bot and receive responses generated by the AI model.
- **`/summarize`**: Summarize the last 24 hours of group messages, combined with contextual inputs.
- **`/reset`**: Clear the conversation history for a fresh start.

## Prerequisites

### **1. Telegram Bot Token**
- Obtain a bot token via [BotFather](https://core.telegram.org/bots#botfather) on Telegram.
- Use the `/newbot` command and follow the setup instructions to receive your API key.

### **2. OpenWebUI**
- Install OpenWebUI from the [OpenWebUI GitHub repository](https://github.com/OpenWebUI/open-webui).
- Start the OpenWebUI server and note the URL (e.g., `http://localhost:3000/api`).

### **3. Python 3.10+**
- Ensure Python 3.10 or later is installed on your system.

## Installation & Setup

### **1. Clone the Repository**

```bash
git clone https://github.com/rmssantos/telegram-openwebui-bot.git
cd telegram-openwebui-bot
```

### **2. Configure the `.env` File**

- Copy the example file and edit it with your configuration:

```bash
cp .env.example .env
```

- Update the `.env` file with your details:

```env
#Telegram Botfather API Key
API_KEY=<YOUR_API_KEY>

#OPENWEBUI API
OPENWEBUI_BASE_URL=http://<OPENWEBUI_BASE_URL>/api
OPENWEBUI_API_KEY=<YOU_OPENWEBUI_API_KEY>

# Custom configs
MODEL_NAME=<YOUR_OPENWEBUI_MODEL>
MAX_TOKENS=500
TEMPERATURE=0.7
CUSTOM1_COLLECTION_ID=<YOUR_OPENWEBUI_COLLECTION_ID>
# Add other KB IDs as needed
CUSTOM2_COLLECTION_ID=<YOUR_OPENWEBUI_COLLECTION_ID>

HISTORY_LENGTH=10
```

### **3. Install Dependencies**

```bash
pip install -r requirements.txt
```

### **4. Run the Bot**

```bash
python bot.py
```

- The bot will start listening for messages. Test it by sending a message on Telegram.

## Docker Setup (Optional)

### **1. Build the Docker Image**

```bash
docker build -t telegram-openwebui-bot .
```

### **2. Run the Docker Container**

```bash
docker run -d --env-file $(pwd)/.env --name telegram_openwebui_bot telegram-openwebui-bot
```

- Ensure your `.env` file is correctly configured.

## Commands

- **`/chat <message>`**: Chat with the bot using OpenWebUI.
- **`/summarize`**: Get a structured summary of recent group messages.
- **`/reset`**: Clear the chat history.

## Environment Variables

- `API_KEY`: Telegram bot token from BotFather.
- `OPENWEBUI_BASE_URL`: Base URL of the OpenWebUI server.
- `OPENWEBUI_API_KEY`: API key for OpenWebUI, if applicable.
- `MODEL_NAME`: Model name to use with OpenWebUI.
- `MAX_TOKENS`: Maximum tokens for AI responses.
- `TEMPERATURE`: Sampling temperature for AI.
- `HISTORY_LENGTH`: Number of messages to keep for context.
- `CUSTOM1_COLLECTION_ID`: ID for the first knowledge base collection.
- `CUSTOM2_COLLECTION_ID`: ID for the second knowledge base collection.

## Troubleshooting

- **Connection Issues**: Ensure OpenWebUI is running and accessible via the specified URL.
- **Environment Variables**: Verify `.env` settings.
- **Debug Logs**: Check logs for detailed error messages.

## Contributing

Contributions are welcome! Please open an issue to discuss changes before submitting a pull request.

---

For more details, refer to the [GitHub repository](https://github.com/rmssantos/telegram-openwebui-bot).


